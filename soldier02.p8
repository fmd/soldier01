pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
raw_sprite_store="floor=181|void=255|select=46|choose=30|bad=15|vault=31"raw_map_store="actor_player=17,1,33,49|actor_enemy_clock=208,192,224,240|actor_enemy_line=209,193,225,241|actor_enemy_cc=210,194,226,242|actor_enemy_still=211,195,227,243|door_multidoor=88,89|door_keydoor=104,105|item_ration=180|item_keycard=185|item_equip=133|object_trapdoor=176|object_relay=132|object_multikey=136"raw_animations="player=17,18,19,18,21,23,22,20:1,2,3,2,5,7,6,4:33,34,35,34,37,39,38,36:49,50,51,50,53,55,54,52:8,9,10,11:12,13:25,24,25,24|enemy=208,209,210,209,210,211,211,1:192,193,194,193,194,195,195,1:224,225,226,225,226,227,227,1:240,241,242,241,242,243,243,1:196,197,198,199:230,231:41,40,41,40:228,229,244,245|door=67,129:68,130|keydoor=104,160:105,161|multidoor=88,144:89,145|multikey=136,137|blood_prints=26,27,28,29|trapdoor=176,177|relay=132,186|ration=180|equip=133|keycard=185"raw_global_objects="actor=nil|object=nil|relay=nil|door=nil|trapdoor=nil|prints=nil|item=nil|multikey=nil"function unmarshal_store(b)local e={}elements=split(b,"|")for g in all(elements)do split_elements=split(g,"=")key,value=split_elements[1],split_elements[2]if split_elements[2]=="nil"then e[key]={}else split_values=split(value,":")e[key]={}for s in all(split_values)do split_commas=split(s)local j={}if#split_commas==1 then add(j,split_commas[1])else add(j,split_commas)end;if#j==1 then j=j[1]end;add(e[key],j)end;if#e[key]==1 then e[key]=e[key][1]end end end;return e end;sprite_store=unmarshal_store(raw_sprite_store)map_store=unmarshal_store(raw_map_store)animations=unmarshal_store(raw_animations)enemy_variants={player={player={5,5}},enemy={clock={5,13},line={5,2},cc={5,6},still={5,5}}}levels={{0,0,36,30}}level_items={{"diving_suit","gloves"}}level_keydoors={{2,1,1,2,2}}level_multidoors={{{{10,17},{12,17}},{{23,24},{25,27}}}}level_cutscene_triggers={{{1,3,1,false},{8,5,2,true},{8,12,5,true}}}characters={"soldier","colonel","rose"}cutscenes={{{8,5},"2|soldier, do you read me?|3|he's badly hurt, colonel.|2|soldier, if you can hear me, go to the relay. you'll have to swim through the water.|3|good luck, soldier.",0,0,3},{{10,6},"1|colonel, do you read me?|2|loud and clear soldier, but watch out. there are trapdoors ahead.",0,3,2},{{11,11},"2|blue keycards unlock blue doors. watch out for enemies.|1|got it.|3|colonel, his vitals don't look good.",0,4,1},{{11,8},"2|soldier, press ‚ùé to wait a turn. move into the same tile as an enemy for a melee attack.|3|soldier, this is important: time your moves in advance.",0,0,1},{{11,17},"2|good work, soldier. enemies will follow the direction of bloody footprints beneath them.|3|ahead lies a multi-lock door. you must lead an enemy over these scanners so that they both turn green. this will unlock the door.",0,0,2}}function split_cutscene(k,n)bits=split(k,"|")if#bits<n*2 then return end;return{bits[n*2-1],bits[n*2]}end;cutscene=0;bar_frames={}turn,chunk,frame,biframe,last_frame=0,0,1,1,0;global_time,turn_start=nil,nil;input_act,input_dir,input_down=0,0,{false,false,false,false,false,false}last_camera_pos={x=0,y=0}queued_input=nil;level_loaded=false;current_level=0;local q={}local r={}local u={}local w={}local x={}local y={}local z={}function reset_global_objects()global_objects=unmarshal_store(raw_global_objects)inventory={}global_object_counts={}queued_input=nil end;mset_restore={}checkpoint={active_relays={},inventory={keycard_level=0,gloves=false,diving_suit=false,socom=false}}function _init()load_level(1)trigger_cutscenes()end;function _update60()if not level_loaded or not player then return end;local A=take_input()if A and A[1]>1 and player.life<=0 and game_speed==3 then load_level(current_level)return end;if A and not queued_input then queued_input=A end;if cutscene>0 then cutscene_diff=flr((time()-cutscene_time)*1000)cutscene_total_diff=cutscene_total_diff+cutscene_diff;msg_chars=cutscenes[cutscene][3]msg_parts=split_cutscene(cutscenes[cutscene][2],cutscene_msg)if not msg_parts then cutscene=cutscenes[cutscene][4]reset_cutscenes()return end;character=msg_parts[1]msg=msg_parts[2]printmsg={""}printline=1;for i=1,#msg,1 do if msg_chars>=i then local c=sub(msg,i,i)local n=#printmsg[printline]if not(n==0 and c==" ")then printmsg[printline]=printmsg[printline]..c end;if n>=26 and(c==" "or c==","or c==".")then printline=printline+1;printmsg[printline]=""end end end;if cutscene_total_diff>50 then msg_chars=msg_chars+1;cutscenes[cutscene][3]=msg_chars;cutscene_total_diff=0;if msg_chars<#msg then sfx(22)if queued_input and queued_input[1]>1 then cutscenes[cutscene][3]=#msg end else if queued_input and queued_input[1]>1 then cutscene_msg=cutscene_msg+1;cutscenes[cutscene][3]=0 end end;queued_input=nil end;cutscene_time=time()return end;update_frame()if turn_start then if chunk>999 then end_turn()if player.frames.n==0 then game_speed=3 end end;return end;if player.life>0 then if queued_input and queued_input[1]>4 then queued_input[1]=queued_input[1]-3 end;player.input_act=queued_input;queued_input=nil;if not player.input_act then return end;player:determine_act()if player:act_pos()==player.pos and player.input_act[1]==1 then return end;start_turn()player.input_act=nil end;if not turn_start and chunk>499 then start_turn()end end;function _draw()cls()if not level_loaded or not player then return end;local p=to_pixel(player.pos)local B=false;local C=make_vec2d(0,0)local D=cutscenes[cutscene]if cutscene>0 then B=cutscene_msg==D[5]C=make_vec2d(D[1][1],D[1][2])if B then p=to_pixel(make_vec2d(C.x,C.y+0.5))end end;buffer=make_vec2d(0,0)if p~=last_camera_pos then buffer=p-last_camera_pos;buffer.x=-buffer.x/1.12;buffer.y=-buffer.y/1.12;if abs(buffer.x)<0.1 then buffer.x=0 end;if abs(buffer.y)<0.1 then buffer.y=0 end end;camera(p.x+flr(buffer.x)-56,p.y+flr(buffer.y)-56)last_camera_pos=p+buffer;draw_map(make_vec2d(last_camera_pos.x/16,last_camera_pos.y/16))draw_set(global_objects.object)draw_set(global_objects.actor)if player.life>0 then draw_set({player})end;local v=make_vec2d(player.pos.x,player.pos.y)local E=sprite_store.select;local F=false;local G=player.act;if G and G[1]==1 then local p=v+dir_to_vec(G[2])if p:is_vault_gate()and inventory.gloves then p=p+dir_to_vec(G[2])end;if p:is_wall()then F=true end;if not F then v=p end end;if queued_input and queued_input[1]==1 then local p=v+dir_to_vec(queued_input[2])if p:is_vault_gate()and inventory.gloves then p=p+dir_to_vec(queued_input[2])end;if p:is_wall()then F=true end;if not F then v=p end end;local H=to_pixel(v)F=false;if v~=player.pos then zspr(E,H.x,H.y)end;if input_act==1 and not queued_input then E=sprite_store.select;local I=false;local p=dir_to_vec(input_dir)+v;if p:is_wall()then F=true end;if p:is_vault_gate()and inventory.gloves then F=false;I=true end;local H=to_pixel(p)E=sprite_store.choose;if F then E=sprite_store.bad end;if I then E=sprite_store.vault end;zspr(E,H.x,H.y)end;local J=player:tile_shift()local K=make_vec2d(p.x+3+J.x*2,p.y-7+J.y*2)if cutscene==0 and player.life>0 then if input_act==5 then print("üÖæÔ∏è",K.x,K.y,8)end;if input_act==6 then print("‚ùé",K.x,K.y,11)end;local L={"‚¨ÜÔ∏è","‚û°Ô∏è","‚¨áÔ∏è","‚¨ÖÔ∏è"}if input_dir>0 then local v=dir_to_vec(input_dir)v.x=v.x*8;v.y=v.y*6;v=v+K;if input_act>1 then print(L[input_dir],v.x,v.y,7)end end end;camera(0,0)draw_bar("life",player.life,player.max_life,3,2,0)if player:in_water()then draw_bar("o2",player.o2,player.max_o2,12,1,1)end;if inventory.keycard_level>0 then draw_keycard_ui()end;if player.blood_prints>0 then draw_blood_ui()end;ypress=0;if input_act>1 then ypress=1 end;if cutscene>0 then local n=#printmsg;local M=(4-n)*7;rectfill(0,97+M,127,127,0)rectfill(0,88+M,49,127,0)zspr(199+character,2,89+M,2,1,1,5,5)print(characters[character],13,90+M,7)line(13,96+M,39,96+M,7)for i=1,#printmsg,1 do print(printmsg[i],3,92+M+i*7,7)end;print("üÖæÔ∏è",42,91+M,2)print("üÖæÔ∏è",42,90+M+ypress,8)end;if player.life<=0 and game_speed==3 then print("you died.",48,54,2)print("you died.",48,53,8)print("press üÖæÔ∏è to respawn",27,77,2)print("press üÖæÔ∏è to respawn",27,76+ypress,8)end;rectcolor=3;if turn_start~=nil then rectcolor=5 end;if bar_frames["life"][2]>0 then rectcolor=8 end;rect(0,0,127,127,rectcolor)end;function load_level(l)game_speed=3;level_loaded=false;reset_global_objects()player=nil;inventory=copymt(checkpoint.inventory)global_time=time()cutscene_time=time()restore_msets(current_level)current_level=l;for N=0,levels[l][4]-1,1 do for O=0,levels[l][3]-1,1 do local v=make_vec2d(O,N)local t=lmapget(v,l)local o=get_tile_pattern(t)if o then add(mset_restore,{v,t})lmapset(v,l,extract_object_from_map(v,o))end end end;c=checkpoint.current_relay;if c then local a=make_actor(make_vec2d(c.x,c.y),{"actor","player",2})add(global_objects.actor,a)player=a end;level_loaded=true end;function extract_object_from_map(P,Q)local R={}if Q[1]=="actor"then if Q[2]~="player"or not checkpoint.current_relay then R=make_actor(P,Q)add(global_objects.actor,R)if Q[2]=="player"then player=R end end else R=make_object(P,Q)if Q[1]=="object"then add(global_objects[Q[2]],R)else add(global_objects[Q[1]],R)end;if Q[2]=="trapdoor"or Q[1]=="door"then return sprite_store.void end end;return sprite_store.floor end;function make_object(P,Q,S)local t={pattern=Q[1],subpattern=Q[2],pos=make_vec2d(P.x,P.y),facing=Q[3]or 1}mt=copymt(r)mk="make_"..t.subpattern;if not global_object_counts[t.subpattern]then global_object_counts[t.subpattern]=0 end;global_object_counts[t.subpattern]=global_object_counts[t.subpattern]+1;mmm=w[mk]if not S then mmm(t,mt)add(global_objects.object,t)end;setmetatable(t,mt)return t end;function make_actor(P,Q)local t=make_object(P,Q,true)t.life,t.max_life=1,1;t.aquatic=false;t.move_type=Q[4]t.blood_prints,t.stunned_turns=0,0;t.laser={frames=0,target=make_vec2d(0,0),dir=0,tiles={}}t.frames={n=0,pattern=""}t.act={0,0}local mt=copymt(q)if Q[2]=="player"then w.make_player(t,mt)end;setmetatable(t,mt)return t end;function w.make_player(t,mt)t.aquatic=true;t.move_type="player"t.life,t.max_life=3,3;local T=3;if inventory.diving_suit then T=6 end;t.o2,t.max_o2=T,T;function mt.__index.determine_act(self)self.act=copymt(self.input_act)self:turn_to_face_act()end;function mt.__index.act_pos(self)local U=y.act_pos(self)if not inventory.gloves or not(self.act[2]>0)then return U end;local d=dir_to_vec(self.act[2])if(d+self.pos):is_vault_gate()and self.act[1]==1 then local V=d+d+self.pos;if V:is_wall()then return make_vec2d(self.pos.x,self.pos.y)end;return V end;return U end end;function make_item(t,mt)function mt.__index.activate(self)if self.pos==player.pos then self:pick_up()del(global_objects.item,self)del(global_objects.object,self)end end;function mt.__index.pick_up(self)end;function mt.__index.draw(self)local p=to_pixel(self.pos)local W=abs(biframe-4)-3;if not turn_start then W=3 end;zspr(self:sprite(),p.x,p.y-W)end end;function w.make_door(t,mt)t.solid=1;function mt.__index.draw(self)end;function mt.__index.draw_above(self)local p=to_pixel(self.pos)zspr(animations[self.subpattern][self.facing][1-self.solid+1],p.x,p.y)end end;function w.make_multidoor(t,mt)t.scanner_positions=level_multidoors[current_level][global_object_counts["multidoor"]]w.make_door(t,mt)function mt.__index.activate(self)if self.solid==0 then return end;local X=true;for p in all(self.scanner_positions)do local s=make_vec2d(p[1],p[2])local o=s:objects_on_here(nil,"multikey")[1]if not o or o.activated==0 then X=false end;o.door=self end;if X then self.solid=0;sfx(16)end end end;function w.make_keydoor(t,mt)t.keycard_level=level_keydoors[current_level][global_object_counts["keydoor"]]w.make_door(t,mt)function mt.__index.activate(self)if self.solid==0 then return end;if self.pos:is_adjacent(player.pos)then if inventory.keycard_level>=self.keycard_level then sfx(16)self.solid=0 else sfx(17)end end end end;function w.make_relay(t,mt)t.active=0;for p in all(checkpoint.active_relays)do if t.pos==p then t.active=1 end end;local c=checkpoint.current_relay;function mt.__index.activate(self)if player.life<=0 or player.pos~=self.pos or self.active~=0 then return end;sfx(18)self.active=1;v=make_vec2d(self.pos.x,self.pos.y)del(checkpoint.active_relays,v)add(checkpoint.active_relays,v)player.life=player.max_life;checkpoint.inventory=copymt(inventory)checkpoint.current_relay=copymt(self.pos)end;function mt.__index.sprite(self)return animations.relay[self.active+1]end;function mt.__index.draw(self)end;function mt.__index.draw_above(self)local p=to_pixel(self.pos)zspr(self:sprite(),p.x,p.y)end end;function w.make_keycard(t,mt)make_item(t,mt)function mt.__index.pick_up(self)if player.life<=0 then return end;inventory.keycard_level=inventory.keycard_level+1;sfx(14)end end;function w.make_ration(t,mt)make_item(t,mt)function mt.__index.pick_up(self)if player.life<=0 then return end;player.life=player.max_life;sfx(15)end end;function w.make_equip(t,mt)make_item(t,mt)t.equip=level_items[current_level][global_object_counts["equip"]]function mt.__index.pick_up(self)inventory[t.equip]=true;if t.equip=="diving_suit"then player.max_o2=6;player.o2=6 end;sfx(21)end end;function w.make_multikey(t,mt)t.activated=0;function mt.__index.draw(self)local p=to_pixel(self.pos)zspr(animations[self.subpattern][1+self.activated],p.x,p.y)end;function mt.__index.activate(self)local Y=self.pos:actors_on_here()for a in all(Y)do if a.life>0 and a~=player then local d=self.door;if d then if d.solid==1 then self.activated=1;sfx(19)end;d:activate()end;return end end end end;function w.make_trapdoor(t,mt)t.timer=false;function mt.__index.activate(self)if self.timer then self.timer=false;self.facing=2;sfx(13)end;local Y=self.pos:actors_on_here()if not Y then return end;for a in all(Y)do if a.life>-2 then if self.facing==1 then sfx(11)self.timer=true;return end;sfx(5)a:fall()end end end end;function get_tile_pattern(Z)for pattern,_ in pairs(map_store)do local p=split(pattern,"_")if not check_type(_,"table")then if _==Z then return{p[1],p[2],1}end else for f,i in pairs(_)do if i==Z then return{p[1],p[2],f,p[3]}end end end end;return nil end;function restore_msets(l)for m in all(mset_restore)do mset(m[1].x+levels[l][1],m[1].y+levels[l][2],m[2])end;mset_restore={}end;function lmapget(v,l)l=l or current_level;return mget(v.x+levels[l][1],v.y+levels[l][2])end;function lmapset(v,l,Z)mset(v.x+levels[l][1],v.y+levels[l][2],Z)end;function start_turn()for a0 in all(global_objects.actor)do if a0.life>0 then a0:determine_act()a0:pickup_prints()if a0.blood_prints>=1 then a0:place_new_prints("blood_prints")end end end;local a1=true;while a1 do a1=false;for a0 in all(global_objects.actor)do if a0~=player and a0.life>0 then a1=a0:do_avoidance()or a1 end end end;turn=turn+1;global_time=time()turn_start=time()update_frame()end;function end_turn()turn_start=nil;global_time=time()if player.blood_prints>=1 then player:redirect_existing_prints("blood_prints")end;for a in all(global_objects.actor)do a:tick_oxygen()if a.blood_prints>=1 then a.blood_prints=a.blood_prints-1 end;if a~=player then a:attempt_act(1)end end;player:attempt_melee()player:attempt_act(1)for a in all(global_objects.actor)do a:attempt_act(2)a.act={0,0}end;for o in all(global_objects.object)do o:activate()end;trigger_cutscenes()end;function trigger_cutscenes()reset_cutscenes()local a2=level_cutscene_triggers[current_level]if not player.pos then return end;for t in all(a2)do if player.pos.x==t[1]and player.pos.y==t[2]then cutscene=t[3]end end end;function reset_cutscenes()cutscene_msg=1;cutscene_total_diff=0;printmsg=""end;function btnpress(i)if i>4 then input_act=i;if input_dir==0 then input_dir=player.facing end else input_dir=i;if input_act<5 then input_act=1 end end end;function take_input()local a3={btn(2),btn(1),btn(3),btn(0),btn(4),btn(5)}for i=1,6 do if a3[i]and not input_down[i]then input_down[i]=true;btnpress(i)elseif not a3[i]and input_down[i]then input_down[i]=false;temp_act=input_act;if input_act==i or input_dir==i and input_act==1 then input_act=0;return{temp_act,input_dir}end end end;return nil end;function cut_chunk(c,v,m)return mid(1,flr(c/v)+1,m)end;function update_frame()chunk=flr((time()-global_time)*1000*game_speed)frame=cut_chunk(chunk,250,4)biframe=cut_chunk(chunk,125,8)if frame~=last_frame and chunk>250 then roll_frame()last_frame=frame end end;function roll_frame()for a in all(global_objects.actor)do if a.laser.frames>0 then a.laser.frames=a.laser.frames-1 end;if a.frames.n>0 then a.frames.n=a.frames.n-1 end end;for a4,a5 in pairs(bar_frames)do if a5[2]>0 then bar_frames[a4]={a5[1],a5[2]-1}end end end;function zspr(n,a6,a7,a8,a9,h,ssw,ssh)local v=n_to_vec(n)a9=a9 or 1;h=h or 1;ssw=ssw or 8;ssh=ssh or 8;a8=a8 or 2;sw,sh=ssw*a9,ssh*h;dw,dh=sw*a8,sh*a8;sspr(v.x,v.y,sw,sh,a6,a7,dw,dh)end;function draw_set(aa)for o in all(aa)do o:draw_below()end;for o in all(aa)do o:draw()end;for o in all(aa)do o:draw_above()end end;function draw_map(ab)for N=levels[current_level][2],levels[current_level][4]-1,1 do if N<ab.y+5 and N>ab.y-5 then for O=levels[current_level][1],levels[current_level][3]-1,1 do if O>ab.x-5 and O<ab.x+5 then local v=make_vec2d(O,N)local ac=to_pixel(v)local Z=lmapget(v)if Z==182 then if frame<2 then Z=183 elseif frame>3 then Z=184 end end;if Z>0 then zspr(Z,ac.x,ac.y)end end end end end end;function draw_bar(ad,ae,af,ag,ah,ai)if not bar_frames[ad]then bar_frames[ad]={ae,0}end;border=6;if bar_frames[ad][1]>ae then bar_frames[ad][2]=2 end;bar_frames[ad][1]=ae;if bar_frames[ad][2]>0 then border=8 end;barp=ai*10;shake=border-6;rect(2+shake,2+barp,af*5+3+shake,7+barp,border)rectfill(3+shake,3+barp,af*5+2+shake,6+barp,ah)if ae>0 then rectfill(3+shake,3+barp,ae*5+2+shake,6+barp,ag)end;printcolor=7;if ae<=0 then printcolor=8 end;print(ad,4+shake,6+barp,printcolor)end;function draw_blood_ui()spr(143,112,3)print(player.blood_prints,121,4,7)end;function draw_keycard_ui()spr(185,85,3)print("lv."..inventory.keycard_level,93,4,7)end;function default_sprite(aj,ak)s=animations[aj]if not check_type(s,"table")then return s end;if ak<=0 or not ak then return s[1]end;if not check_type(s[ak],"table")then return s[ak]end;return s[ak][1]end;function x.sprite(self)return default_sprite(self.subpattern,self.facing)end;function x.draw(self)local p=to_pixel(self.pos)zspr(self:sprite(),p.x,p.y)end;function x.draw_below(self)end;function x.draw_above(self)end;function x.activate(self)end;r.__index=x;function y.act_pos(self)local a=self.act[1]local d=self.act[2]if d==0 then return self.pos end;local al=self.pos+dir_to_vec(d)if a==1 then if not al:is_wall()and(not al:is_water()or self.aquatic)then return al end end;return self.pos end;function y.attempt_melee(self)if self.life<=0 then return end;attack_point=self:act_pos()h=attack_point:actors_on_here("player")for a in all(h)do if a.life>0 then a.stunned_turns=3;sfx(23)player:set_frames("crouch",2)end end end;function y.tick_oxygen(self)if self:in_water()then if self.o2<=0 and self.life>0 then self:hurt(1,true)end;if self.o2>=1 then self.o2=self.o2-1;sfx(12)end else self.o2=self.max_o2 end end;function y.in_water(self)return self.pos:is_water()and self:act_pos():is_water()end;function y.turn_to_face_act(self)if self.act[2]>0 then self.facing=self.act[2]end end;function y.determine_act(self)if self.life<=0 then self.act={a=0,d=0}return end;if self.stunned_turns>0 then self.stunned_turns=self.stunned_turns-1;if self.stunned_turns>0 then return end;ha=self.pos:actors_on_here()if ha and ha[1].life>0 and ha[1]~=self then self.stunned_turns=1;return end end;previous_facing=self.facing;follow_prints=self.pos:objects_on_here("prints","blood_prints")if follow_prints then self.facing=follow_prints[1].facing end;self.act[1]=1;self.act[2]=self.facing;self:determine_facing()if player.life<=0 then return end;tiles=self:tiles_ahead(previous_facing,true)for a4,Z in pairs(tiles)do if player.pos==Z then self.act={2,previous_facing}self.facing=previous_facing;sfx(10)return end end;tiles=self:tiles_ahead(self.facing,true)for a4,Z in pairs(tiles)do if player.pos==Z then self.act[1]=2;sfx(10)return end end;self:turn_to_face_act()end;function y.determine_facing(self)local am=self.move_type;local apos=self:act_pos()if am=="clock"then local an=0;while apos==self.pos do local f=self.facing+1;if f>4 then f=5-f end;self.act[2],self.facing=f,f;apos=self:act_pos()an=an+1;if an>4 then self.stunned_turns=3;return end end end;if am=="still"then self.act={0,0}return end;if am=="line"then if apos==self.pos then f=self.facing+2;if f>4 then f=abs(5-f)+1 end;self.act[2],self.facing=f,f end end;if am=="cc"then local an=0;while apos==self.pos do f=self.facing-1;if f<1 then f=4 end;self.act[2],self.facing=f,f;apos=self:act_pos()an=an+1;if an>4 then self.stunned_turns=3;return end end end end;function y.do_avoidance(self)if self.act[1]>1 then return false end;local ao=self:act_pos()for a in all(global_objects.actor)do if a.life>0 then apos=a:act_pos()if a~=self and apos==ao and a.subpattern~="player"then self.act={0,0}return true end end end;return false end;function y.pickup_prints(self)for a in all(global_objects.actor)do if a.life<=0 and a.pos==self.pos then self.blood_prints=6;return end end end;function y.place_new_prints(self,aj)if self.life<=0 or self.pos:is_water()or self.pos:objects_on_here(nil,"trapdoor")then return end;p=self.pos:objects_on_here("prints",aj)if not p then d=self.act[2]if d<=0 then d=self.facing end;o=make_object(self.pos,{"prints",aj,d},true)add(global_objects.prints,o)add(global_objects.object,o)end end;function y.attempt_act(self,ap)a=self.act[1]if a==1 and ap==1 then self:attempt_move()end;if a==2 and ap==2 then self:attempt_shot()end end;function y.attempt_move(self)self.pos=self:act_pos()end;function y.attempt_shot(self)sfx(4)tiles={}for i,Z in pairs(self:tiles_ahead(self.act[2],true))do hurts={}add(tiles,Z)as=Z:actors_on_here()if as then for a in all(as)do if a and self~=a and a.life>0 then add(hurts,a)end end end;l=#hurts;for a in all(hurts)do if l>1 then if a~=player and a.life>0 then a:hurt()self:queue_lasers(tiles,a)return end elseif l==1 then a:hurt()self:queue_lasers(tiles,a)return end end end end;function y.redirect_existing_prints(self,aj)if self.life<=0 then return end;p=self.pos:objects_on_here("prints",aj)if not p then return end;if self.act[2]>0 then p[1].facing=self.act[2]end end;function y.set_frames(self,pattern,n)self.frames={pattern=pattern,n=n}end;function y.queue_lasers(self,tiles,a,d)d=d or self.act[2]self.laser={frames=2,target=a.pos,dir=d,tiles={}}del(tiles,tiles[#tiles])self.laser.tiles=tiles end;function y.hurt(self,aq,ar)aq=aq or 1;self.life=max(0,self.life-aq)if self.life==0 then sfx(5)if not ar then self:set_frames("death",4)end;if self==player then game_speed=1 end else sfx(5,-1,1,3)if not ar then self:set_frames("hurt",2)end end end;function y.fall(self)self.life=-2;self:set_frames("fall",2)if self==player then game_speed=1 end end;function y.tiles_ahead(self,d,at)at=at or false;if d<=0 then d=self.facing end;p=self.pos+dir_to_vec(d)collected={}i=1;while not(p:is_wall()and(not p:is_glass()or not at))do collected[i]=p;i=i+1;p=p+dir_to_vec(d)end;return collected end;function y.draw_sprite(self)local p=to_pixel(self.pos)local s=self:tile_shift()ssw,ssh,y_shift=8,8,0;if self:in_water()then ssh=4;y_shift=2 end;palswap=enemy_variants[self.subpattern][self.move_type]pal(palswap[1],palswap[2])zspr(self:sprite(),p.x+s.x*2,p.y+s.y*2+y_shift,2,1,1,ssw,ssh)pal(palswap[1],palswap[1])end;function y.draw_below(self)if self.life>0 then return end;self:draw_sprite()end;function y.draw(self)if self.life<=0 then return end;self:draw_sprite()end;function y.draw_above(self)anim=animations[self.subpattern][7]if self.act[1]==2 then d=self.act[2]if self==player and input_act==5 then d=input_dir end;if d<=0 then d=self.facing end;s=anim[d]tiles=self:tiles_ahead(d,true)for Z in all(tiles)do t=to_pixel(Z)zspr(s,t.x,t.y)end end;l=self.laser;s=anim[l.dir]if l.frames>0 and l.dir>0 then for Z in all(l.tiles)do if l.frames==1 then pal(8,2)pal(11,3)end;t=to_pixel(Z)l_dir_mod=(l.dir+1)%2;zspr(s,t.x,t.y)zspr(s,t.x+l_dir_mod*2,t.y+(1-l_dir_mod)*2)pal(8,8)pal(11,11)end end end;function y.sprite(self)frames_n=self.frames.n;pattern=self.subpattern;frames_pattern=self.frames.pattern;if frames_n>0 then if frames_pattern=="death"then return animations[pattern][5][4-frames_n+1]end;if frames_pattern=="hurt"then return animations[pattern][5][2-frames_n+1]end;if frames_pattern=="fall"then return animations[pattern][6][2-frames_n+1]end;if frames_pattern=="crouch"then return animations[pattern][self.facing][7]end end;if self.life<=0 then if self.life==-2 then return 255 end;return animations[pattern][5][4]end;if self.stunned_turns==1 then return animations[pattern][8][frame%2+3]end;if self.stunned_turns>0 then return animations[pattern][8][frame%2+1]end;anim=animations[pattern][self.facing]if turn_start~=nil then if self.act[1]==1 then return anim[frame+1]end end;if cutscene==0 then if input_act==6 and self==player and turn_start==nil then return animations[pattern][input_dir][1]end;if input_act==5 and self==player and turn_start==nil then anim=animations[pattern][input_dir]end;if self.act[1]==2 or input_act==5 and self==player and turn_start==nil then return anim[6]end end;return default_sprite(pattern,self.facing)end;function y.tile_shift(self)apos=self:act_pos()if not(apos==self.pos)and turn_start then return make_vec2d((apos.x-self.pos.x)*biframe,(apos.y-self.pos.y)*biframe)end;return make_vec2d(0,0)end;q.__index=y;pos_map={{0,1,0,-1},{-1,0,1,0}}function dir_to_vec(au)return make_vec2d(pos_map[1][au],pos_map[2][au])end;function make_vec2d(O,N)local t={x=O,y=N}setmetatable(t,u)return t end;function z.distance_to(self,P)local v=P-self;return sqrt(v.x*v.x+v.y*v.y)end;function z.is_adjacent(self,P)return self.x==P.x+1 and self.y==P.y or self.x==P.x-1 and self.y==P.y or self.x==P.x and self.y==P.y+1 or self.x==P.x and self.y==P.y-1 end;function get_global_objects(pattern,aj)pattern=pattern or aj;local av={}for o in all(global_objects[pattern])do if not aj or o.subpattern==aj then add(av,o)end end;return av end;function z.objects_on_here(self,pattern,aj)local av,aw=get_global_objects(pattern,aj),{}for o in all(av)do if o.pos==self then add(aw,o)end end;if#aw>0 then return aw end;return nil end;function z.actors_on_here(self,ax)ax=ax or""local Y={}for a in all(global_objects.actor)do if a.pos==self and a.subpattern~=ax then add(Y,a)end end;if#Y>0 then return Y end;return nil end;function z.is_glass(self)m=lmapget(self)return m==119 or m==120 end;function z.is_wall(self)a=self:objects_on_here("door")if a and a[1].solid==1 then return true end;m=lmapget(self)return m>=64 and m<=127 end;function z.is_vault_gate(P)m=lmapget(P)return m==70 or m==71 end;function z.is_water(P)return lmapget(P)==182 end;function u.__add(a,a5)return make_vec2d(a.x+a5.x,a.y+a5.y)end;function u.__sub(a,a5)return make_vec2d(a.x-a5.x,a.y-a5.y)end;function u.__eq(a,a5)return a.x==a5.x and a.y==a5.y end;u.__index=z;function check_type(v,t)return type(v)==t end;function copymt(o)local c;if type(o)=='table'then c={}for a4,v in pairs(o)do c[a4]=copymt(v)end else c=o end;return c end;function concat(ay,az)local aA={}for i=1,#ay do aA[i]=ay[i]end;for i=1,#az do aA[#ay+i]=az[i]end;return aA end;function to_pixel(K)return make_vec2d(K.x*16,K.y*16)end;function n_to_vec(n)return make_vec2d(8*(n%16),8*flr(n/16))end
__gfx__
00000000000000000000000000000000441444400000000000000000000000000000010080000000080000000000000000000000000000000000000000000000
0000000000444400000000000104444000411110010444400000000000444400004444100e044400000e08000000000000000000000000000000000002200220
00700700041111000044440004111110100f3f30041111100044440004111100041811408883114000808e800000000000000000000000000000000002002020
0007700001f3f30004111100004f3f30151ffff0004f3f300411110001f3f556043f3f000e8ef340100388140000000000000000000000000000000000020020
0007700004ffff0001f3f300000ffff015111f1f000ffff001f3f30004ffff500888fff01888f440108e8f14000388e100444400000000000000000000200200
0070070000111000041fff0000f11f0000000000001110f0044fff0000111f000081110005811480051ff34480e88388041f110f000000000000000002002020
000000000f555f0000111f0000155000000000000f0551000111f1f0005550000f0551008058000805111e801188ff8401f1f301000000000000000002220220
000000000010100000f110000000010000000000001000000015111000101000000001000011000000f110e811f8844004f1ff0100f000f00000000000000000
000000000000000000000000000000000000000000000000000000000005000000000000000b0000008800000000000000000000000000003300003300000000
00000000004440000000000000444100000000000004140000000000004440000000000000000000008800000000000000800000000000003000000333000033
000000000444440000044400044414001041440000444140004440000444440000000000000b0000008000000000088800880000000088800000000030000003
00000000011111000044444001111100111114400011111004444400011111000b0b0b0b000000000000000000000088008800000000880000000000000bb000
000000000f441400001111100f44440015555100004444f0011111000f44140000000000000b00000000880000880000000000008800000000000000000bbb00
000000000044400000f4410001544000f11110f00005441004414f0001111f0000000000000000000000880008880000000008008880000000000000000b0000
000000000f555f00000555f0001510000000000000055100015551000055500000000000000b0000000008000000000000008800000000003000000330000003
000000000010100000f1110000100f000000000000f0010000111000001010000000000000000000000000000000000000008800000000003300003333000033
00000000000000000000000000100000004444000000010000000000000000000000000000008000000000003300003300000000000000000000000000000000
00000000004444000000000001444400041111000044441000000000004444000000000000000000000000003000000300000000000000000330033033000033
00000000041111000044440004111140103f34000411114000444400041114000000000000008000000000000000000000000000000000000300003030000003
00000000013f3f000411110000f3f34001fff410043f3f0000111140043f3400000000000000000000000000000bb00000000000000000000000000000bbbb00
0000000000ffff0001f3f3000fffff000f111f0000fffff0003f3f1001f5f10008080808000080000000000000bbbb0000000000000000000000000000bb0000
0000000000111000041fff0000111100001150000011110001fff100001611000000000000000000000000000000000000000000000000000300003000b00000
000000000f555f0000111f00001550f0000000000f055100011f1100005f50000000000000008000000000003000000300000000000000000330033030000003
000000000010100000f5100000100000000000000000010000115f10001010000000000000000000000000003300003300000000000000000000000033000033
00000000000000000000000000000000044441440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004444000000000004444010011114000444401000000000004444000033300000222000000000000000000000000000000000000000000000000000
0000000000111140004444000111114003f3f00101111140004444000011114003bbb30002888200000000000000000000000000000000000000000000000000
00000000003f3f100011114003f3f4000ffff15103f3f40000111140655f3f103b3b3b3028828820000000000000000000000000000000000000000000000000
0000000000ffff40003f3f100ffff000f1f111510ffff000003f3f1005ffff403bb3bb3028282820000000000000000000000000000000000000000000000000
000000000001110000fff14000f11f00000000000f01110000fff44000f111003b3b3b3028828820000000000000000000000000000000000000000000000000
0000000000f555f000f111000005510000000000001550f00f1f11100005550003bbb30002888200000000000000000000000000000000000000000000000000
000000000001010000011f0000100000000000000000010001115100000101000033300000222000000000000000000000000000000000000000000000000000
0000000000000000000000000156651000100100000000000010010000150100015665100c11c110011c11c07656651077777777015665670000000000000000
00111111111111111111110001125110110110111001000101011010010510101115651110101011110101017756651077717776015665771111111100000000
01567555515675555556651000025000510000155111501155666655010610111555651001006105501600107756611055551555015661775555155500000000
016566666566566666665610010250106555555661556655515150511106101065661101c00511666611500c7756651066666566015665176666656600000000
01666666666666666667661001025010622222266656615650505050011601006611500c10116656656611017655651066566666015565676656666600000000
01576551155665551556651000025000510000155155101501010100111610115016001001565551155565107756651051555555015665775155555500000000
01566111115755111116651001125110110110110011000100000000010510101101110111565111111565117716651011111111011665776776766700000000
0156651001566110015665100156651000000000000000000000000000150101011c00c001566510015665107656651000000000015665677777777600000000
01566510015665100116651005555550000100000115651001001000001001000156651000100100015661100776667600000000000000000000000000000000
01566510111665111155751152222225016111500015510010110100010110100119511011011011110655111111116600000000000000000000000000000000
01566110155665515556655152222225115567110006100010166655566610100009500051000015101165155155566700000000000000000000000000000000
01567510666666666667666659444495065676510056610010160510150610100109501065555556c16165566665667600000000000000000000000000000000
01556510656566656665766559244295151565510115651001060500050601000109501069999996010516666666667700000000000000000000000000000000
01566510555665515556655559554595115651610015551010161010101610100009500051000015010015555555566700000000000000000000000000000000
01166510115665111111111154999945156715100011610000160101010610010119511011011011c01001111111116600000000000000000000000000000000
01566510000561000000000005555550001550000156650001051000001501000156651000000000010c10106777666700000000000000000000000000000000
01566510000000000156651000166510010000000000010001061000001601000156651000100100010000000156651000000000000000000000000000000000
0156611111111111111665100016651100550000015611101016010001061010011c51101101101100510000011c511000000000000000000000000000000000
0156655155551555155665100156655111166010156766501016655555661010000c50005100001511151010000c500000000000000000000000000000000000
0166766666676576666676100166666601557600015675001015051015051010010c501065555556015160000101501000000000000000000000000000000000
0165666666566666666656100165666500016510000167100105050005050100010c50106cccccc600015110010c501000000000000000000000000000000000
0157655551555555555665100156655100011500000016511010101010101010000c500051000015000115000001500000000000000000000000000000000000
0011111111111111111111000016651100100010000055710011010101011001011c51101101101100100010011c511000000000000000000000000000000000
00000000000000000000000000156100000000110000115001001000001001000156651000000000000000110156651000000000000000000000000000000000
00111100011665100000000001566100000000000000000001511100005c75000010010000000000005c75000010010000000000000000000000000000000000
011551100156651001111111115561001111111015155100166510100107c01001011010011111110c00c0100101101000000000000000000000000000000000
01566110015565101155551515566510515555115666661005510010000cc00050000005111555550000000050c0000500000000000000000000000000000000
01566510015665101566566666666610666566516681666156500001010cc0107cccc7cc1566666601000010700000cc00000000000000000000000000000000
01556510015661101566666656665610666666516110166166510010010cc010c7cccc7c1566566601000c10c700000c00000000000000000000000000000000
01566510011551101115555515566510555551116100156106651010000c70005000000511555515000c00005000000500000000000000000000000000000000
011665100011110001111111115661001111111066555610156551510107c01001011010011111110107101001011c1000000000000000000000000000000000
01566510000000000000000000166100000000000166610051115500005cc5000010010000000000005cc5000010010000000000000000000000000000000000
0010010001566510000000000010010000000000000000000010010001000010001001000010010000100100bbbbbbbb88888888666666666666666600008000
010110100112511011011011010110100dccccd0000000000101101003bbbb30011651500116515001165150b333333b82222228611000111000111600088800
00000000000000005100001501555510d000000d000000000155551033333333016115100161151001611510b33bbb3b8282222861b308218208211688008800
0100001001000010600000560281182000dccd000055850003b11b300000000000582100005b3100005a9100b3bbbb3b82282228601110001110001688000880
010000100100001060000026028118200d0000d00000000003b11b30bbbbbbbb001285000013b5000019a500b3b3333b82228228608218208218200608800000
00000000000000005100001501555510000cc000005585000155551033333333015116100151161001511610b33bbb3b82228828600011100011100600008800
01011010010000101101101101011010010bb010005555000101101001000010051561100515611005156110b333333b8222222861b9c8110001110600008880
0010010001000010000000000010010001333310000000000010010013bbbb31001001000010010000100100bbbbbbbb88888888666666666666666600000088
01566510000000007777677777777677001001000666776677676600001001000000000667777777776766608888888888888888bbbbbbbbbbbbbbbb00000000
01195110110110117677767777677767060110100167677777777760060110100101666706777677777777008222222222222228b33333333333333b00000000
00000000510000156777777767767777676060601006777776777601676060001006777706776776767776018288882929292928b3bbbb333993993b00010000
01000010600000567777777777777767677676760167777777676010677676100167777706777777776760108288222929292928b3b3bbb33993993b00171000
01000010600000967777676767767676777777670106767777777610777777600106767701676776777776108282222222222228b3bb3b333333333b00171000
00000000510000156777767767606066677677771067776777776001677677601067776700060676766760018222222929292928b33333333993993b00111000
01000010110110117777777706011016776777760677777777767610776777600677777701011060760610108222222222222228b33333333333333b00171000
01000010000000007776777600100100777777760066767776776000777777760066767700100100600000008888888888888888bbbbbbbbbbbbbbbb00000000
01566510000000007777677777776777777776777777677701000001010000017717617700000000000000000000000000000000000000000000000000055000
011c5110110110117766767776777777767766777677777710000310100003107116515700000000000000000000000000000000007777000005560000500050
00000000510000156766777767776667677766776777766600000300030003006161151700000000000000000005500000677000077777700000056050000050
0100001060000056776777777777766777777777777776670300100103001001765821670000000000000800005d850006777700077777700650005000500500
01000010600000c67777777776677777776777677667777703010010000100107612856700000000000556000056650000777700077777700650005550000000
000000005100001567776677666776776766767776667777001001300018010061511617000000000066666000066000006776000a7777a00065000500000050
0100001011011011777766777777777777667777777777770100103101031001751561170000000000000000000000000000600000aaaa000006650000005000
01000010000000007777767677767776777777767776777610010010100100107716717600000000000000000000000000000000000000000000000055500000
0010010001555510005c750000100100000000000100010101000000000000000000000000000000000000000300030300000000000000000000000000000000
01011010500000050c00c01001011010000000001001101000c0000000000000100000000000000003bbbb303003303000000000000000000000000000000000
00000000050550500000000050c00005000bb000001001010c1cc00c0c01c0c101cc00c100c0ccc0d000000d0030030300000000000000000000000000000000
010000100000000001000010700000cc00b11b000100101001011c0101cc1c101011cc10001c1110003bb3000300303000000000000000000000000000000000
011111100000000001000c10c700000c00b33b00100100100c00011c0011010001001100001111100d0000d03003003000000000000000000000000000000000
0000000000000000000c000050000005003bb30000100100c1cc0cc1c0c000c0ccc0000000ccccc0000bb0000030030000000000000000000000000000000000
01000010000000000107101001011c1000033000010010011011c1101c1cc110101ccc1000000000010aa0100300300300000000000000000000000000000000
0011110005555550005cc50000100100000000001001001000001000010111000001110000000000019999103003003000000000000000000000000000000000
00000000000000000000000000000000000001008000000008000000000000000444400000339000099990000000000000000000000000000000000000000000
00555500000000000005555005555000000555100e055500000e080000000000411110000333300099cfc0000000000000000000000000000000000000000000
05555500005555000055555055555000005855508883115000808e80000000001f3f30006f4f400099fff0000000000000000000000000000000000000000000
02f3f30005555500002f3f302f3f3000003f3f200e8ef35010038855000000004ffff0001ffff000022000000000000000000000000000000000000000000000
05ffff0002f3f300000ffff00fff55600888fff01888f520108e8f55000388e50000000000000000000000000000000000000000000000000000000000000000
00111000001fff0000f11f000111f5000081110005811080051ff32580e883880000000000000000000000000000000000000000000000000000000000000000
0f555f0000111f0000155000055500000f0551008058000805111e801188ff850000000000000000000000000000000000000000000000000000000000000000
0010100000f110000000010001010000000001000011000000f110e811f882500000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000006000007060007800000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00555000000000000055500000055500070555000555500000555000000555500000000000000000000000000000000000000000000000000000000000000000
05555500000555000555550000555550705555505555507005555570070555550000000000000000000000000000000000000000000000000000000000000000
05555200005555500555520000555520705555202f3f3007023f35077003f3f20000000000000000000000000000000000000000000000000000000000000000
00fff000005555200ffff00000f555f000f555000ffff00705fff107700ffff00000000000000000000000000000000000000000000000000000000000000000
001110000001110000511000001111f0001111f001111f55011ff66055f111100000000000000000000000000000000000000000000000000000000000000000
0f555f00000555f00015500000055500000555000555000000555000000055500000000000000000000000000000000000000000000000000000000000000000
0010100000f1110000100f0000010100000101000101000000101000000010100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0055550000000000005555000055500000a90a0000a0990000000000000000000000000000000000000000000000000000000000000000000000000000000000
05555550005555000555555005555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
02f3f3500555555002f3f350023f3500000f3550000f355000000000000000000000000000000000000000000000000000000000000000000000000000000000
00ffff0002f3f3500fffff00056ff10000fff55000fff55000555500000000000000000000000000000000000000000000000000000000000000000000000000
00111000001fff000011110000f11100051f3550051f3550055f550f00000f000000000000000000000000000000000000000000000000000000000000000000
0f555f0000111f00001550f000555000151ff550151ff55002f5f305000005000000000000000000000000000000000000000000000000000000000000000000
0010100000f51000001000000010100011f0250011f0250005f5ff05000005000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00555500000000000555500000055550000090000009a00000000000000000000000000000000000000000000000000000000000000000000000000000000000
00555550005555000555550000055555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
003f3f200055555003f3f2000003f3f2000f3550000f355000000000000000000000000000000000000000000000000000000000000000000000000000000000
00ffff00003f3f200ffff0000655fff000fff55000fff55000000000000000000000000000000000000000000000000000000000000000000000000000000000
0001110000fff10000f11f00005f1110051f3550051f355000000000000000000000000000000000000000000000000000000000000000000000000000000000
00f555f000f111000005510000005550151ff550151ff55000000000000000000000000000000000000000000000000000000000000000000000000000000000
0001010000011f00001000000000101011f0250011f0250000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50666666666666666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50622222222222222260000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50622222222222222260000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50622222222222222260000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50627222777277727770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50667666676676667660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50007000070077007700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50007000070070007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50007770777070007770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50666666666666666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50611111111111111160000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50611111111111111160000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50611111111111111160000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50611771777111111160000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50667676667666666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50007070777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50007070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50007700777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000100000001000000010000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000001000000010000000100000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50001110101011101010111010101110101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000101000001010000010100000101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000001011000010110000101100001011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000001100000011000000110000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000010001000100010001000100010001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000000001100000011000000110000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000010001000100010001000100010001001000000010000000000000000000000000000000000000000000000000000000000000000000000000000000005
50000101c0010101c0010101c0010101c00100010000000100000000000000000000000000000000000000000000000000000000000000000000000000000005
5010011c1100011c1100011c1100011c110011101010111010100000000000000000000000000000000000000000000000000000000000000000000000000005
50001c0110101c0110101c0110101c01101001010000010100000000000000000000000000000000000000000000000000000000000000000000000000000005
5110001101c1001101c1001101c1001101c100010110000101100000000000000000000000000000000000000000000000000000000000000000000000000005
50001100cc011100cc011100cc011100cc0100011000000110000000000000000000000000000000000000000000000000000000000000000000000000000005
5010011c0110011c0110011c0110011c011000100010001000100000000000000000000000000000000000000000000000000000000000000000000000000005
50111010100010101000101010001010100000000011000000110000000000000000000000000000000000000000000000000000000000000000000000000005
50100100100000100100001001000010001001011000001000100100000001000000010000000100000001000000010000000100000001000000000000000005
50011011010001011010010110100101c001115111500101c0010001000000010000000100000001000000010000000100000001000000010000000000000005
5100101666555566665556661010011c110011555611011c11001110101011101010111010101110101011101010111010101110101011101010000000000005
50101016051051515051150610101c011010055665511c0110100101000001010000010100000101000001010000010100000101000001010000000000000005
51c1010605005050505005060100001101c115156551001101c10001011000010110000101100001011000010110000101100001011000010110000000000005
5c011016101001010100101610101100cc01151551511100cc010001100000011000000110000001100000011000000110000001100000011000000000000005
5110001601010000000001061001011c011011565510011c01100010001000100010001000100010001000100010001000100010001000100010000000000005
50000105100000000000001501001010100005155010101010000000001100000011000000110000001100000011000000110000001100000011000000000005
50000011110000100100001501000010001000100010001000100010001000100010001000100010001000100010001000100010001000000000000000000005
50000115511001011010010510100101c0010101c00101012202220222022201c0012202c202220222010101c0010101c0010101c00100111111111111111115
5010015661100000000001061011011c1100011c11000118818882888288811c11088282828881888200011c1100011c1100011c110001566555555515555555
50000156651001000010110610101c0110101c0110101c821082828882822c011082828282822c8280101c0110101c0110101c01101001656666666665666665
5110015565100100001001160100001101c1001101c100820288828282880011018282828288008802c1001101c1001101c1001101c101666666665666666655
50000156651000000000111610111100cc011100cc0111828282828282822200cc8281888c82228282012100cc011100cc011100cc0101566551515555555155
5010011665100101101001051010011c0110011c011001888180818c8188811c018801180188818c8118011c0110011c0110011c011001566111111111111115
50110156651000100100001501011010100010101000101010001010100010101000101010001010100010101000101010001010100001566510000000000005
50000156651000100100011565100000000000100100011c11c00010001000100010010010000010010000100100001001000010010001566510010001010105
50000156651001011010001551001515510001011010110101010101c0010101c001101101000101101001011010010110100101101001566510100110101005
5000015661100000000000061000566666105566665550160010011c1100011c1100101666555566665555666655556666555566665501566110001001010015
500001566510010000100056610066816661515150516611500c1c0110101c011010101605105151505151515051515150515151505101566510010010100105
5000015565100100001001156510611016615050505065661101001101c1001101c1010605005050505050505050505050505050505001556510100100101005
50000156651000000000001555106100156101010100155565101100cc011100cc01101610100101010001010100010101000101010001566510001001000015
5000011665100101101000116100665556100000000011156511011c0110011c0110001601010000000000000000000000000000000001166510010010010105
50000156651000100100015665000166610000000000015665101010100010101000010510000000000000000000000000000000000001566510100100101005
50000156651001555510015665100010010000100100015665100010001000100010001501000010010000100100001001000010010001566510010001010115
50000156651050000005015665100101101001011010015665100101c0010101c001010510100dccccd0010110100101101001011010011851101001101003b5
5000015661100505505001566110000000000000000001566110011c1100011c110001061011d000000d00000000000000000000000000000000001001013335
50000156651000000000015665100100001001000010015665101c0110101c0110101106101001dccd1001000010010000100100001001000010010010100105
5000015565100000000001556510555055500550555055555550555155510011555155565550055005500100555001005050010000100100001010010010bbb5
5000015665100000000001566517775777007707770777577757770777511107775777577711770c770000077750050757500000000000000000001001003335
5000011665100000000001166517570755175551751757575710751c075001175757570755175557555001011710755717100101101001000010010010010105
500001566510055555500156651770577107775075077757755075107700101777077057710777577750001071077710715000100100010000101001001013b5
50000156651000100100015665175757555057107507575757507500050000075007575755505710570001575550700757500000000000000000010001010105
5111111665100101101001566517070777177dcc7cd7071767117111711111171117171777177107701011177711111717111111111111111100100110101005
555515566510000000000156611000000000d000000d015665515156655555551555155665510000000015566551555515555555155555566510001001010015
55666666661001000010015665100100001001dccd10016666666566566666666566666666660100001066666666666665666666656666665610010010100105
5666666656100100001001556510010000100d0000d0016566656666666666566666656566650100001065656665665666666656666666666610100100101005
555555566510000000000156651000000000000cc000015665511556655551555555555665510000000055566551515555555155555515566510001001000015
51111111110001011010011665100101101001011010001665111156551111111111115665110101101011566511111111111111111111166510010010010105
50000000000000100100015665100010010000100100001561000156611000000000000561000010010000056100000000000000000001566510100100101005
51000010010000100100001665100010010000100100015665100156610000100100005c75000010010000100100001001000010010000166510000000000005
5010010110100102222000166511010110100101101001566111115561000dddd0100107c0100101101001011010010110100101101000166511111111111115
500000000000002222200156655155666655000000000156655115566510ddddd000000cc0000000000000000000000000000000000001566551555515555555
501001000010012f3f300166666651515051010000100166666666666610df3f3010010cc0100100001001000010010000100100001001666666666665666665
501001000010010ffff001656665505050500100001001656666566656100fffdd60010cc0100100001001000010010000100100001001656665665666666655
50000000000000f11f0001566551010101000000000001566555155665100111fd00000c70000000000000000000000000000000000001566551515555555155
5010010110100112201000166511000000000101101000111111115661000ddd10100107c0100101101001011010010110100101101000166511111111111115
51000010010000100100001561000000000000100100000000000016610001110100005cc5000010010000100100001001000010010000156100000000000005
50000000000000100100015665100010010000100100001001000016651000100100015665100010010001566510000000000000000001166510000000000005
51111111111001011010111665110222201001011010010110100016651101011010111665110101101011166511111111111101101111556511111111000005
55555155551155666655155665510222220000000000000000000156655155666655155665515566665515566551555515555100001555566551555665100005
556666656651515150516666666603f3f21001000010010000100166666651515051666666665151505166666666666665666000005666666666666656100005
56666666665150505050656566650ffff01001000010010000100165666550505050656566655050505065656665665666666000002666656665666666100005
555555555111010101005556655100f11f0000000000000000000156655101010100555665510101010055566551515555555100001555566555155665100005
51111111111000000000115665110102211001011010010110100016651100000000115665110000000011566511111111111101101111111111111665100005
50000000000000000000000561000010010000100100001001000015610000000000000561000000000000056100000000000000000000000000015665100005
510000100100001001000016651000100100001001000010010001566100001001000010010000100100005c7500001001000010010000100100015665100005
5010010110100101101000166511010110100101101001011010115561000101101001011010010110100107c010010110100101101001022220011251100005
500000000000000000000156655155666655000000005566665515566510000000000000000000000000000cc000000000000000000000222220000250000005
501001000010010000100166666651515051010000105151505166666610010000100100001001000010010cc0100100001001000010012f3f30010250100005
501001000010010388ed0165666550505050011111105050505056665610010000100100001001000010010cc0100100001001000010010ffff0010250100005
50000000000080e883880156655101010100000000000101010015566510000000000000000000000000000c7000000000000000000000f11f00000250000005
5010010110101188ff8d00166511000000000100001000000000115661000101101001011010010110100107c010010110100101101001122010011251100005
51000010010011f88dd00015610000000000001111000000000000166100001001000010010000100100005cc500001001000010010000100100015665100005
50000010010000100100015665100010010000100100001001000015010000100100001111000010010000166510001001000000000000000000015661000005
51111101101101011010111665100101101001011010010110100105101001011010011551100101101000166511010110101111111111111111115561000005
5555510000155000000515566510000000000000000000000000010610110000000001566110000bb00001566551000000005156655555551555155665100005
5666655555567cccc7cc6666661001000010010000100100001011061010010000100156651001b11b1001666666010000106566566666666566666666100005
566669999996c7cccc7c6666561001000010010000100100001001160100010000100155651001b33b1001656665011111106666666666566666566656100005
5555510000155000000555566510000000000000000000000000111610110000000001566510003bb30001566551000000001556655551555555155665100005
5511110110110101101011111100010110100101101001011010010510100101101001166510010330100016651101000010115655111111111111bbbbbbbb05
5110001001000010010000000000001001000010010000100100001501010010010001566510001001000015610000111100015661100000000000b333333b05
5510001001000010010000100100001001000010010000100100001001000010010001566510001001000156651000100100005c75000010010001b33bbb3b05
55100101101001011010010110100101101001011010010110100dccccd001011010011251100101101001125110010110100107c010010dddd001b3bbbb3b05
511000000000000bb00000000000000000000000000000000000d000000d0000000000025000015555100000000000000000000cc000000ddddd01b3b3333b05
55100100001001b11b100100001001000010010000100100001001dccd10010000100102501003b11b300100001001000010010cc0100103f3fd01b33bbb3b05
55100100001001b33b10011111100100001001111110010000100d0000d0011111100102501003b11b300100001001000010010cc01006ddfff001b333333b05
551000000000003bb30000000000000000000000000000000000000cc0000000000000025000015555100000000000000000000c700000df111001bbbbbbbb05
55100101101001033010010000100101101001000010010110100101101001000010011251100101101001000010010110100107c0100101ddd0011665100005
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555

__map__
ff64646554646454640000000000000000000000000000000000000000000000000000000000ff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
65b5b6b6b6b64785476400000000000000000000000000000000000000000000000000000000ff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6446465457b66646675400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7501b5b565b65464544154546500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
64b5b5b5b6b6b6b6b550b0b5b564000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
006454b6b6b6b6658471b576b554640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0072454ab6b65454b0b5b054b5b556645400000000000000000000000000000000ffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000604ab6b66465b554c1b5b547b5b565000000000064ffffffff00000000ffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000060414674e1465442b070664646646465644061456454640000000000ffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000ff50b5b5b5b5c377b577f365b6b6b6b6b647b5b5b5b9e36400ff0000ffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000ff50b570b570b571b5506564b55464646551694178b0787364ff0000ffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000405269514673b5b9b550ffff6470b4765454b050b5b5c047b6650000ffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000050b5b5718460464646730064c377b5b5f1b5b568b553b547b6b65400ff0000ffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000006042b0b5b5b0c0b5b56041614562b5645454b550f0b5b570b6b65400000000ffffffff407861616961617842ffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000606142b570b553b5b558b584b5b554c0b5405261616973b6b654ff000000ffffffff50b6b6b6b6b6b6b677ffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000606173b5b5f040516174464657b5b547e347b5b550b6b6b665ff0000ffffffff50b65646464657b650ffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000064637882785262645465b647465460785242b550464657b664ffffffffffff50b647b5b5b547b650ffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000544788b58847b5b664b6b647b081b5b5b5508454b5b5664651616142516161514667b547b5664650ffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000006447b5b5b54764b6b6b6b670b555b5b0b581b55084b5b5b56887b56b6b870168b5b5f347b9b5b568ffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000064b66646464667547246416162b550b5b5f0634651b051616151616162516161514657b547b5564650ffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000005464b6b6b5b5b553e147c1b5b56042b04673c377b5b5b5b563ffffffff000050b647b5b5b547b650fffffeffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000006464b6b6b585b5b5b560616146c377b5b4634651465161825242000000000050b66646464667b650fffffeffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000ff5464b6b6b5b553b5b584b5e3406246b073b5b5b577f1b5b543000000000050b6b6b6b6b6b6b677ffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000064b6b66454544641597862c0b5b547b570b463b0416173ff00000000607861616961617862ffff0000ff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000646400ff64b547b5b4b0b588b584b050b581b577f350ff000000000000ffffffffffffffff000000ff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000006460417842b5b5f04078516151b0516162ff0000000000000000000000000000000000ff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000050d36342b04062b5b5c077b550ff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000060615273b58188b553b581b550ff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000063615242f0b5b5636162000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000060616161620000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000ffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000bfffffffffffffffffff00000000000000bf0000000000000000000000006061526152616200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000802021675016750177501675015750147501575015750137501475015750167501775017750177501775017750177501775017750167501575016750177501875018750187501875018750187501875018750
001000001a752000001a750000001a752000001a750000001a752000001a750000001a752000001a7520000019752000001975200000197520000019750000001575000000157500000015750000001575000000
011000001675000000167500000016750000001675000000167500000016750000001675000000167500000018750000001875000000187500000018750000001575000000157500000015750000001575000000
011000000e7500e7500e7500e7500000016750000001575013750117501075011750137500e750000000d7500d750000000e7500e75010750107500e7500e750000000d7500d7500000000000000000000000000
00120000136300b610046000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000800000f040110300e020110100217001170011500115002100215001d50035600366003760037600386003860038600376003560034600326002f6002b60000000236001d6001760014600106000000000000
00100000160401f0303b7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00050000376403c65037660336602f6502b640246301e630126200e6100a610086100c60005600206000c600046001f6001660010600000000000000000000000000000000000000000000000000000000000000
000a00000114001060010000b600056000b60011f0011f0011f0011f0011f0011f0011f0011f0011f0011f0011f00000000000000000000000000000000000000000000000000000000000000000000000000000
000600000e0201d0000c0000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00040000147401e7401e7301e7201e7101e7001f7001f700207001e70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000800000a1200b1300b1400110001100077000550005500045000350002500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000800001a730167401a7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000c00000712006130071300612000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0008000025710277102c7103172031710000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000800002151024520265202651000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00080000267300a7102d7202d7200a710000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000800000d750017300d7500d75001730000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0008000027510295102b5102e51032520335203253033520325103351000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000001604017040180301802000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000001804017040160301602000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000c0000175101b5101c5101e5101d5201e5201d5201e5201d5202352022520235202253023530225302353023520000000000000000000000000000000000000000000000000000000000000000000000000000
000200001255000010000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000900001173014740235302452023510167001770017700127001770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000001904000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
00 01024344

